<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shelf Life | Southold Free Library</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2563eb;
            margin-bottom: 5px;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 5px;
        }
        .date {
            text-align: center;
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
        }
        .clue {
            background: #dbeafe;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2563eb;
            border-radius: 5px;
        }
        .locked {
            background: #f3f4f6;
            color: #9ca3af;
            border-left-color: #d1d5db;
        }
        input[type="text"] {
            width: 70%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1d4ed8;
        }
        .guess {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .correct {
            background: #dcfce7;
            border: 1px solid #16a34a;
        }
        .incorrect {
            background: #fef2f2;
            border: 1px solid #dc2626;
        }
        .result {
            text-align: center;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .win {
            background: #dcfce7;
            color: #166534;
        }
        .lose {
            background: #fef2f2;
            color: #991b1b;
        }
        .library-link {
            background: #dbeafe;
            padding: 15px;
            text-align: center;
            border-radius: 5px;
            margin: 15px 0;
        }
        .library-link a {
            background: #2563eb;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
        .archive-day {
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .archive-day:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }
        .archive-day.completed {
            background: #dcfce7;
            border-color: #16a34a;
        }
        .archive-day.current {
            background: #dbeafe;
            border-color: #2563eb;
            font-weight: bold;
        }
        .archive-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .archive-date {
            font-weight: bold;
            color: #333;
        }
        .archive-book {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }
        .archive-status {
            font-size: 18px;
        }
        .nav-buttons {
            text-align: center;
            margin-bottom: 20px;
        }
        .nav-buttons button {
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ“š Shelf Life</h1>
    <p class="subtitle">Daily Book Guessing Game</p>
    <p class="date" id="current-date"></p>

    <div class="nav-buttons">
        <button onclick="showTodaysGame()" id="today-btn">ğŸ“… Today's Game</button>
        <button onclick="showArchiveList()" id="archive-btn">ğŸ—‚ï¸ Archive</button>
    </div>

    <div id="game-section">
        <div class="container">
            <h3>ğŸ“‹ Clues (<span id="clue-count">1</span>/6)</h3>
            <div id="clues"></div>
        </div>

        <div class="container" id="input-section">
            <h3>Your Guess</h3>
            <input type="text" id="guess-input" placeholder="Enter book title...">
            <button onclick="makeGuess()">Submit</button>
        </div>

        <div class="container hidden" id="guesses-section">
            <h3>Your Guesses (<span id="guess-count">0</span>/6)</h3>
            <div id="guesses"></div>
        </div>

        <div class="container hidden" id="result-section">
            <div id="result-text"></div>
            <div class="library-link">
                <p>ğŸ“– <strong>Available at Southold Free Library</strong></p>
                <a href="https://southold-suffc.na.iiivega.com" target="_blank">Search Our Catalog</a>
            </div>
        </div>
    </div>

    <div class="container hidden" id="archive-section">
        <h3>ğŸ—‚ï¸ Game Archive</h3>
        <p style="font-size: 14px; color: #666; margin-bottom: 15px;">Click any day to play that puzzle</p>
        <div id="archive-list" style="max-height: 400px; overflow-y: auto;"></div>
    </div>

    <div style="text-align: center; margin-top: 30px; padding: 20px; color: #666; font-size: 14px;">
        <p>Powered by <a href="https://southoldlibrary.org" target="_blank" style="color: #2563eb; text-decoration: none;">Southold Free Library</a></p>
        <p style="font-size: 12px; margin-top: 10px;">Â© 2025 Southold Free Library. All rights reserved.</p>
    </div>

    <script>
        // Extended book list for better variety
        const books = [
            { title: "PRIDE AND PREJUDICE", author: "Jane Austen" },
            { title: "THE GREAT GATSBY", author: "F. Scott Fitzgerald" },
            { title: "TO KILL A MOCKINGBIRD", author: "Harper Lee" },
            { title: "HARRY POTTER AND THE SORCERER'S STONE", author: "J.K. Rowling" },
            { title: "NINETEEN EIGHTY-FOUR", author: "George Orwell" },
            { title: "THE HOBBIT", author: "J.R.R. Tolkien" },
            { title: "JANE EYRE", author: "Charlotte BrontÃ«" },
            { title: "THE CATCHER IN THE RYE", author: "J.D. Salinger" },
            { title: "MOBY DICK", author: "Herman Melville" },
            { title: "WAR AND PEACE", author: "Leo Tolstoy" },
            { title: "THE LORD OF THE RINGS", author: "J.R.R. Tolkien" },
            { title: "BRAVE NEW WORLD", author: "Aldous Huxley" },
            { title: "WUTHERING HEIGHTS", author: "Emily BrontÃ«" },
            { title: "THE SCARLET LETTER", author: "Nathaniel Hawthorne" },
            { title: "LITTLE WOMEN", author: "Louisa May Alcott" },
            { title: "FRANKENSTEIN", author: "Mary Shelley" },
            { title: "DRACULA", author: "Bram Stoker" },
            { title: "ALICE'S ADVENTURES IN WONDERLAND", author: "Lewis Carroll" },
            { title: "THE ADVENTURES OF HUCKLEBERRY FINN", author: "Mark Twain" },
            { title: "CRIME AND PUNISHMENT", author: "Fyodor Dostoyevsky" },
            { title: "THE COUNT OF MONTE CRISTO", author: "Alexandre Dumas" },
            { title: "ANNA KARENINA", author: "Leo Tolstoy" },
            { title: "THE PICTURE OF DORIAN GRAY", author: "Oscar Wilde" },
            { title: "GREAT EXPECTATIONS", author: "Charles Dickens" },
            { title: "A TALE OF TWO CITIES", author: "Charles Dickens" },
            { title: "THE GRAPES OF WRATH", author: "John Steinbeck" },
            { title: "OF MICE AND MEN", author: "John Steinbeck" },
            { title: "FAHRENHEIT 451", author: "Ray Bradbury" },
            { title: "LORD OF THE FLIES", author: "William Golding" },
            { title: "THE OLD MAN AND THE SEA", author: "Ernest Hemingway" }
        ];

        let currentBook;
        let guesses = [];
        let cluesShown = 1;
        let gameOver = false;
        let selectedDate = null;
        let gameHistory = {};

        // Load game history from localStorage (or initialize empty)
        function loadGameHistory() {
            try {
                const saved = localStorage.getItem('shelflife-history');
                gameHistory = saved ? JSON.parse(saved) : {};
            } catch (e) {
                gameHistory = {};
            }
        }

        // Save game history to localStorage
        function saveGameHistory() {
            try {
                localStorage.setItem('shelflife-history', JSON.stringify(gameHistory));
            } catch (e) {
                // localStorage not available, continue without saving
            }
        }

        function normalizeForComparison(title) {
            return title
                .toUpperCase()
                .trim()
                .replace(/[^\w\s]/g, '')
                .replace(/\s+/g, ' ')
                .replace(/\bNINETEEN EIGHTY FOUR\b/g, '1984')
                .replace(/\bNINETEEN EIGHTY THREE\b/g, '1983')
                .replace(/\bNINETEEN EIGHTY TWO\b/g, '1982')
                .replace(/\bNINETEEN EIGHTY ONE\b/g, '1981')
                .replace(/\bNINETEEN EIGHTY\b/g, '1980')
                .replace(/\bTWENTY TWENTY FOUR\b/g, '2024')
                .replace(/\bTWENTY TWENTY THREE\b/g, '2023')
                .replace(/\bTWENTY TWENTY TWO\b/g, '2022')
                .replace(/\bTWENTY TWENTY ONE\b/g, '2021')
                .replace(/\bTWENTY TWENTY\b/g, '2020')
                .replace(/\bTWO THOUSAND\b/g, '2000')
                .replace(/\bTWENTY ONE\b/g, '21')
                .replace(/\bTWENTY TWO\b/g, '22')
                .replace(/\bTWENTY THREE\b/g, '23')
                .replace(/\bTWENTY FOUR\b/g, '24')
                .replace(/\bTWENTY FIVE\b/g, '25')
                .replace(/\bTWENTY SIX\b/g, '26')
                .replace(/\bTWENTY SEVEN\b/g, '27')
                .replace(/\bTWENTY EIGHT\b/g, '28')
                .replace(/\bTWENTY NINE\b/g, '29')
                .replace(/\bTHIRTY\b/g, '30')
                .replace(/\bFORTY\b/g, '40')
                .replace(/\bFIFTY\b/g, '50')
                .replace(/\bSIXTY\b/g, '60')
                .replace(/\bSEVENTY\b/g, '70')
                .replace(/\bEIGHTY\b/g, '80')
                .replace(/\bNINETY\b/g, '90')
                .replace(/\bONE\b/g, '1')
                .replace(/\bTWO\b/g, '2')
                .replace(/\bTHREE\b/g, '3')
                .replace(/\bFOUR\b/g, '4')
                .replace(/\bFIVE\b/g, '5')
                .replace(/\bSIX\b/g, '6')
                .replace(/\bSEVEN\b/g, '7')
                .replace(/\bEIGHT\b/g, '8')
                .replace(/\bNINE\b/g, '9')
                .replace(/\bTEN\b/g, '10')
                .replace(/\bELEVEN\b/g, '11')
                .replace(/\bTWELVE\b/g, '12')
                .replace(/\bTHIRTEEN\b/g, '13')
                .replace(/\bFOURTEEN\b/g, '14')
                .replace(/\bFIFTEEN\b/g, '15')
                .replace(/\bSIXTEEN\b/g, '16')
                .replace(/\bSEVENTEEN\b/g, '17')
                .replace(/\bEIGHTEEN\b/g, '18')
                .replace(/\bNINETEEN\b/g, '19')
                .replace(/\bTWENTY\b/g, '20')
                .replace(/\bHUNDRED\b/g, '100')
                .replace(/\bTHOUSAND\b/g, '1000')
                .trim();
        }

        function titlesMatch(guess, target) {
            return normalizeForComparison(guess) === normalizeForComparison(target);
        }

        function getDateKey(date) {
            return date.toISOString().split('T')[0];
        }

        function getTodaysBook(date = null) {
            const targetDate = date || selectedDate || new Date();
            const dayOfYear = Math.floor((targetDate - new Date(targetDate.getFullYear(), 0, 0)) / 86400000);
            return books[dayOfYear % books.length];
        }

        function showCurrentDate() {
            const targetDate = selectedDate || new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = targetDate.toLocaleDateString('en-US', options);
        }

        function generateClues(book) {
            const specificClues = {
                "PRIDE AND PREJUDICE": [
                    "ğŸŒŸ A spirited woman and proud gentleman overcome first judgments to find love",
                    "ğŸ‘¤ Author: British author, Austen",
                    "ğŸ“… Published: 1813",
                    "ğŸ­ Themes: Social class, marriage, personal growth through understanding",
                    "ğŸ“– Setting: English countryside estates in the Regency era", 
                    "ğŸ‘¥ Character: Elizabeth Bennet"
                ],
                "THE GREAT GATSBY": [
                    "ğŸŒŸ A mysterious millionaire throws lavish parties hoping to win back his lost love",
                    "ğŸ‘¤ Author: American author, Fitzgerald",
                    "ğŸ“… Published: 1925",
                    "ğŸ­ Themes: The American Dream, wealth vs morality, impossible past",
                    "ğŸ“– Setting: Long Island and New York City, summer of 1922",
                    "ğŸ‘¥ Character: Jay Gatsby"
                ],
                "TO KILL A MOCKINGBIRD": [
                    "ğŸŒŸ A child witnesses her father defend an innocent man in a charged trial",
                    "ğŸ‘¤ Author: American author, Lee", 
                    "ğŸ“… Published: 1960",
                    "ğŸ­ Themes: Racial injustice, moral courage, loss of innocence",
                    "ğŸ“– Setting: Small town Alabama during the 1930s",
                    "ğŸ‘¥ Character: Scout Finch"
                ],
                "HARRY POTTER AND THE SORCERER'S STONE": [
                    "ğŸŒŸ An orphaned boy discovers he's famous in a magical world",
                    "ğŸ‘¤ Author: British author, Rowling",
                    "ğŸ“… Published: 1997", 
                    "ğŸ­ Themes: Good vs evil, friendship, sacrifice, coming of age",
                    "ğŸ“– Setting: A school of witchcraft and wizardry in Scotland",
                    "ğŸ‘¥ Character: Harry Potter"
                ],
                "NINETEEN EIGHTY-FOUR": [
                    "ğŸŒŸ In a surveillance state where Big Brother watches all, one man dares remember freedom",
                    "ğŸ‘¤ Author: British author, Orwell",
                    "ğŸ“… Published: 1949",
                    "ğŸ­ Themes: Totalitarianism, surveillance, truth manipulation, individual freedom",
                    "ğŸ“– Setting: Dystopian London under constant government monitoring",
                    "ğŸ‘¥ Character: Winston Smith"
                ],
                "THE HOBBIT": [
                    "ğŸŒŸ A reluctant home-loving creature embarks on an unexpected adventure with thirteen companions",
                    "ğŸ‘¤ Author: British author, Tolkien",
                    "ğŸ“… Published: 1937",
                    "ğŸ­ Themes: Adventure, courage, greed, heroism from unlikely sources",
                    "ğŸ“– Setting: Middle-earth, including the Shire and Lonely Mountain",
                    "ğŸ‘¥ Character: Bilbo Baggins"
                ],
                "JANE EYRE": [
                    "ğŸŒŸ An orphaned governess faces a brooding employer with dark secrets",
                    "ğŸ‘¤ Author: British author, Charlotte BrontÃ«",
                    "ğŸ“… Published: 1847",
                    "ğŸ­ Themes: Independence, love vs. morality, social class, religion",
                    "ğŸ“– Setting: Yorkshire moors and Thornfield Hall in Victorian England",
                    "ğŸ‘¥ Character: Jane Eyre"
                ],
                "THE CATCHER IN THE RYE": [
                    "ğŸŒŸ A troubled teenager wanders New York City after being expelled from prep school",
                    "ğŸ‘¤ Author: American author, Salinger",
                    "ğŸ“… Published: 1951",
                    "ğŸ­ Themes: Alienation, loss of innocence, phoniness in adult world",
                    "ğŸ“– Setting: New York City in the 1950s",
                    "ğŸ‘¥ Character: Holden Caulfield"
                ],
                "MOBY DICK": [
                    "ğŸŒŸ A ship captain's obsessive quest for revenge against a white whale",
                    "ğŸ‘¤ Author: American author, Melville",
                    "ğŸ“… Published: 1851",
                    "ğŸ­ Themes: Obsession, fate vs. free will, nature's power, isolation",
                    "ğŸ“– Setting: Aboard a whaling ship sailing the world's oceans",
                    "ğŸ‘¥ Character: Captain Ahab"
                ],
                "WAR AND PEACE": [
                    "ğŸŒŸ Russian aristocratic families navigate love and loss during Napoleon's invasion",
                    "ğŸ‘¤ Author: Russian author, Tolstoy",
                    "ğŸ“… Published: 1869",
                    "ğŸ­ Themes: War's impact, fate, love, history's forces on individuals",
                    "ğŸ“– Setting: Russia during the Napoleonic Wars (1805-1820)",
                    "ğŸ‘¥ Character: Pierre Bezukhov"
                ],
                "THE LORD OF THE RINGS": [
                    "ğŸŒŸ A fellowship forms to destroy a ring that could doom their world",
                    "ğŸ‘¤ Author: British author, Tolkien",
                    "ğŸ“… Published: 1954-1955",
                    "ğŸ­ Themes: Good vs. evil, friendship, sacrifice, power's corruption",
                    "ğŸ“– Setting: Middle-earth, from the Shire to Mount Doom",
                    "ğŸ‘¥ Character: Frodo Baggins"
                ],
                "BRAVE NEW WORLD": [
                    "ğŸŒŸ In a future society of engineered happiness, one man questions the system",
                    "ğŸ‘¤ Author: British author, Huxley",
                    "ğŸ“… Published: 1932",
                    "ğŸ­ Themes: Technology's control, individuality vs. conformity, happiness vs. truth",
                    "ğŸ“– Setting: Futuristic World State society",
                    "ğŸ‘¥ Character: John the Savage"
                ],
                "WUTHERING HEIGHTS": [
                    "ğŸŒŸ A foundling's obsessive love spans generations on the Yorkshire moors",
                    "ğŸ‘¤ Author: British author, Emily BrontÃ«",
                    "ğŸ“… Published: 1847",
                    "ğŸ­ Themes: Destructive love, revenge, social class, nature vs. civilization",
                    "ğŸ“– Setting: Wuthering Heights and Thrushcross Grange on Yorkshire moors",
                    "ğŸ‘¥ Character: Heathcliff"
                ],
                "THE SCARLET LETTER": [
                    "ğŸŒŸ A woman bears shame and an illegitimate child in Puritan New England",
                    "ğŸ‘¤ Author: American author, Hawthorne",
                    "ğŸ“… Published: 1850",
                    "ğŸ­ Themes: Sin and redemption, guilt, hidden truth, social judgment",
                    "ğŸ“– Setting: Puritan Boston in the 1640s",
                    "ğŸ‘¥ Character: Hester Prynne"
                ],
                "LITTLE WOMEN": [
                    "ğŸŒŸ Four sisters grow up during the Civil War, facing poverty and personal challenges",
                    "ğŸ‘¤ Author: American author, Alcott",
                    "ğŸ“… Published: 1868",
                    "ğŸ­ Themes: Family bonds, women's roles, poverty vs. wealth, moral growth",
                    "ğŸ“– Setting: Concord, Massachusetts during the Civil War",
                    "ğŸ‘¥ Character: Jo March"
                ],
                "FRANKENSTEIN": [
                    "ğŸŒŸ A scientist creates life but abandons his creation with horrific consequences",
                    "ğŸ‘¤ Author: British author, Mary Shelley",
                    "ğŸ“… Published: 1818",
                    "ğŸ­ Themes: Scientific ethics, creation vs. responsibility, isolation, revenge",
                    "ğŸ“– Setting: Geneva, Switzerland and the Arctic",
                    "ğŸ‘¥ Character: Victor Frankenstein"
                ],
                "DRACULA": [
                    "ğŸŒŸ An ancient vampire travels to England to spread his curse",
                    "ğŸ‘¤ Author: Irish author, Stoker",
                    "ğŸ“… Published: 1897",
                    "ğŸ­ Themes: Good vs. evil, modernity vs. tradition, fear of the foreign",
                    "ğŸ“– Setting: Transylvania and Victorian England",
                    "ğŸ‘¥ Character: Count Dracula"
                ],
                "ALICE'S ADVENTURES IN WONDERLAND": [
                    "ğŸŒŸ A curious girl falls down a rabbit hole into a world of nonsense",
                    "ğŸ‘¤ Author: British author, Carroll",
                    "ğŸ“… Published: 1865",
                    "ğŸ­ Themes: Growing up, logic vs. nonsense, identity, authority",
                    "ğŸ“– Setting: Wonderland, a fantastical underground world",
                    "ğŸ‘¥ Character: Alice"
                ],
                "THE ADVENTURES OF HUCKLEBERRY FINN": [
                    "ğŸŒŸ A boy and an escaped slave travel down the Mississippi River seeking freedom",
                    "ğŸ‘¤ Author: American author, Twain",
                    "ğŸ“… Published: 1884",
                    "ğŸ­ Themes: Racism, moral growth, freedom vs. civilization, friendship",
                    "ğŸ“– Setting: Mississippi River in the antebellum American South",
                    "ğŸ‘¥ Character: Huckleberry Finn"
                ],
                "CRIME AND PUNISHMENT": [
                    "ğŸŒŸ A student commits murder and struggles with guilt and philosophical justification",
                    "ğŸ‘¤ Author: Russian author, Dostoyevsky",
                    "ğŸ“… Published: 1866",
                    "ğŸ­ Themes: Guilt and redemption, morality, poverty, psychological torment",
                    "ğŸ“– Setting: St. Petersburg, Russia in the 1860s",
                    "ğŸ‘¥ Character: Rodion Raskolnikov"
                ],
                "THE COUNT OF MONTE CRISTO": [
                    "ğŸŒŸ A wrongly imprisoned man escapes and methodically seeks revenge on his betrayers",
                    "ğŸ‘¤ Author: French author, Dumas",
                    "ğŸ“… Published: 1844",
                    "ğŸ­ Themes: Justice vs. revenge, forgiveness, transformation, hope",
                    "ğŸ“– Setting: France and Italy in the early 19th century",
                    "ğŸ‘¥ Character: Edmond DantÃ¨s"
                ],
                "ANNA KARENINA": [
                    "ğŸŒŸ A married aristocrat's affair leads to tragedy while others find happiness",
                    "ğŸ‘¤ Author: Russian author, Tolstoy",
                    "ğŸ“… Published: 1877",
                    "ğŸ­ Themes: Love vs. duty, society's constraints, faith, family",
                    "ğŸ“– Setting: Russian high society in the 1870s",
                    "ğŸ‘¥ Character: Anna Karenina"
                ],
                "THE PICTURE OF DORIAN GRAY": [
                    "ğŸŒŸ A young man's portrait ages while he remains beautiful but morally corrupt",
                    "ğŸ‘¤ Author: Irish author, Wilde",
                    "ğŸ“… Published: 1890",
                    "ğŸ­ Themes: Beauty vs. morality, hedonism, art's influence, corruption",
                    "ğŸ“– Setting: Victorian London",
                    "ğŸ‘¥ Character: Dorian Gray"
                ],
                "GREAT EXPECTATIONS": [
                    "ğŸŒŸ An orphan boy receives mysterious wealth and learns hard lessons about class",
                    "ğŸ‘¤ Author: British author, Dickens",
                    "ğŸ“… Published: 1861",
                    "ğŸ­ Themes: Social class, ambition vs. loyalty, love, personal growth",
                    "ğŸ“– Setting: Victorian England, London and the marshes of Kent",
                    "ğŸ‘¥ Character: Pip"
                ],
                "A TALE OF TWO CITIES": [
                    "ğŸŒŸ Love and sacrifice unfold against the backdrop of the French Revolution",
                    "ğŸ‘¤ Author: British author, Dickens",
                    "ğŸ“… Published: 1859",
                    "ğŸ­ Themes: Sacrifice, resurrection, duality, revolution's chaos",
                    "ğŸ“– Setting: London and Paris during the French Revolution",
                    "ğŸ‘¥ Character: Sydney Carton"
                ],
                "THE GRAPES OF WRATH": [
                    "ğŸŒŸ A family of farmers travels to California during the Great Depression",
                    "ğŸ‘¤ Author: American author, Steinbeck",
                    "ğŸ“… Published: 1939",
                    "ğŸ­ Themes: Social injustice, family unity, human dignity, survival",
                    "ğŸ“– Setting: Oklahoma to California during the Dust Bowl era",
                    "ğŸ‘¥ Character: Tom Joad"
                ],
                "OF MICE AND MEN": [
                    "ğŸŒŸ Two migrant workers dream of owning a farm during the Great Depression",
                    "ğŸ‘¤ Author: American author, Steinbeck",
                    "ğŸ“… Published: 1937",
                    "ğŸ­ Themes: Friendship, loneliness, dreams vs. reality, mercy",
                    "ğŸ“– Setting: California ranch during the Great Depression",
                    "ğŸ‘¥ Character: George Milton"
                ],
                "FAHRENHEIT 451": [
                    "ğŸŒŸ In a future where books are burned, a fireman begins to question his job",
                    "ğŸ‘¤ Author: American author, Bradbury",
                    "ğŸ“… Published: 1953",
                    "ğŸ­ Themes: Censorship, knowledge vs. ignorance, technology's impact, rebellion",
                    "ğŸ“– Setting: Dystopian future America",
                    "ğŸ‘¥ Character: Guy Montag"
                ],
                "LORD OF THE FLIES": [
                    "ğŸŒŸ British schoolboys stranded on an island descend into savagery",
                    "ğŸ‘¤ Author: British author, Golding",
                    "ğŸ“… Published: 1954",
                    "ğŸ­ Themes: Civilization vs. savagery, human nature, power, loss of innocence",
                    "ğŸ“– Setting: Uninhabited tropical island",
                    "ğŸ‘¥ Character: Ralph"
                ],
                "THE OLD MAN AND THE SEA": [
                    "ğŸŒŸ An aging fisherman battles a giant marlin in the Gulf Stream",
                    "ğŸ‘¤ Author: American author, Hemingway",
                    "ğŸ“… Published: 1952",
                    "ğŸ­ Themes: Perseverance, dignity in defeat, man vs. nature, isolation",
                    "ğŸ“– Setting: Cuban waters and the Gulf Stream",
                    "ğŸ‘¥ Character: Santiago"
                ]
            };
            
            return specificClues[book.title] || [
                "ğŸŒŸ A compelling story that has captivated readers for generations",
                `ğŸ‘¤ Author: ${getAuthorNationality(book.author)}, ${book.author.split(' ').slice(-1)[0]}`,
                `ğŸ“… Era: ${getEstimatedYear(book.title)}`,
                `ğŸ­ Themes: ${getGenericThemes(book.title)}`,
                `ğŸ“– Setting: ${getGenericSetting(book.title)}`,
                "ğŸ‘¥ Features: Memorable characters facing profound challenges"
            ];
        }

        function getAuthorNationality(author) {
            if (author.includes('Dickens') || author.includes('Austen') || author.includes('BrontÃ«') || author.includes('Carroll') || author.includes('Tolkien')) return 'British author';
            if (author.includes('Twain') || author.includes('Hemingway') || author.includes('Steinbeck') || author.includes('Fitzgerald')) return 'American author';
            if (author.includes('Tolstoy') || author.includes('Dostoyevsky')) return 'Russian author';
            if (author.includes('Hugo') || author.includes('Dumas')) return 'French author';
            return 'International author';
        }

        function getEstimatedYear(title) {
            if (title.includes('HARRY POTTER')) return '1990s-2000s';
            if (title.includes('HUNGER GAMES') || title.includes('TWILIGHT')) return '2000s-2010s';
            if (title.includes('DA VINCI') || title.includes('KITE RUNNER')) return 'Modern era';
            return 'Classic period';
        }

        function getGenericThemes(title) {
            if (title.includes('WAR') || title.includes('BATTLE')) return 'Conflict, courage, human cost of war';
            if (title.includes('LOVE') || title.includes('ROMANCE')) return 'Love, relationships, passion, heartbreak';
            if (title.includes('MURDER') || title.includes('CRIME')) return 'Mystery, justice, human nature';
            if (title.includes('ADVENTURE')) return 'Adventure, discovery, personal growth';
            return 'Human nature, morality, society, personal growth';
        }

        function getGenericSetting(title) {
            if (title.includes('LONDON') || title.includes('ENGLAND') || title.includes('BRITISH')) return 'England';
            if (title.includes('PARIS') || title.includes('FRANCE')) return 'France';
            if (title.includes('AMERICA') || title.includes('NEW YORK')) return 'America';
            if (title.includes('WAR')) return 'Times and places of conflict';
            if (title.includes('FUTURE') || title.includes('SPACE')) return 'Future or imaginary worlds';
            return 'Various meaningful locations that shape the story';
        }

        function showClues() {
            const clues = generateClues(currentBook);
            const cluesContainer = document.getElementById('clues');
            cluesContainer.innerHTML = '';
            
            for (let i = 0; i < cluesShown; i++) {
                const clueDiv = document.createElement('div');
                clueDiv.className = 'clue';
                clueDiv.textContent = clues[i];
                cluesContainer.appendChild(clueDiv);
            }
            
            document.getElementById('clue-count').textContent = cluesShown;
        }

        function makeGuess() {
            if (gameOver) return;
            
            const input = document.getElementById('guess-input');
            const guess = input.value.trim();
            
            if (!guess) return;
            
            const isCorrect = titlesMatch(guess, currentBook.title);
            guesses.push({ text: guess.toUpperCase(), correct: isCorrect });
            
            input.value = '';
            
            if (isCorrect) {
                gameOver = true;
                endGame(true);
            } else {
                cluesShown = Math.min(6, cluesShown + 1);
                showClues();
                
                if (guesses.length >= 6) {
                    gameOver = true;
                    endGame(false);
                }
            }
            
            displayGuesses();
            saveGameState();
        }

        function displayGuesses() {
            if (guesses.length === 0) return;
            
            document.getElementById('guesses-section').classList.remove('hidden');
            const guessesContainer = document.getElementById('guesses');
            guessesContainer.innerHTML = '';
            
            guesses.forEach(guess => {
                const guessDiv = document.createElement('div');
                guessDiv.className = `guess ${guess.correct ? 'correct' : 'incorrect'}`;
                guessDiv.textContent = guess.text;
                guessesContainer.appendChild(guessDiv);
            });
            
            document.getElementById('guess-count').textContent = guesses.length;
        }

        function endGame(won = false) {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            
            const resultDiv = document.getElementById('result-text');
            if (won) {
                resultDiv.innerHTML = `
                    <div class="result win">
                        <h3>ğŸ‰ Congratulations!</h3>
                        <p>You guessed "${currentBook.title}" by ${currentBook.author} in ${guesses.length} guess${guesses.length === 1 ? '' : 'es'}!</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="result lose">
                        <h3>ğŸ“š Better luck next time!</h3>
                        <p>The book was "${currentBook.title}" by ${currentBook.author}</p>
                    </div>
                `;
            }
        }

        function saveGameState() {
            const dateKey = getDateKey(selectedDate || new Date());
            gameHistory[dateKey] = {
                guesses: guesses,
                cluesShown: cluesShown,
                gameOver: gameOver,
                won: gameOver && guesses.some(g => g.correct),
                book: currentBook
            };
            saveGameHistory();
        }

        function loadGameState() {
            const dateKey = getDateKey(selectedDate || new Date());
            const savedGame = gameHistory[dateKey];
            
            if (savedGame) {
                guesses = savedGame.guesses || [];
                cluesShown = savedGame.cluesShown || 1;
                gameOver = savedGame.gameOver || false;
                
                displayGuesses();
                if (gameOver) {
                    endGame(savedGame.won);
                }
            } else {
                guesses = [];
                cluesShown = 1;
                gameOver = false;
            }
        }

        function showArchiveList() {
            document.getElementById('game-section').classList.add('hidden');
            document.getElementById('archive-section').classList.remove('hidden');
            
            const archiveList = document.getElementById('archive-list');
            archiveList.innerHTML = '';
            
            const today = new Date();
            
            // Show last 30 days
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                
                const dateKey = getDateKey(date);
                const dayData = gameHistory[dateKey];
                const isToday = dateKey === getDateKey(new Date());
                
                const dayDiv = document.createElement('div');
                dayDiv.className = `archive-day ${dayData && dayData.won ? 'completed' : ''} ${isToday ? 'current' : ''}`;
                
                const statusIcon = dayData && dayData.won ? 'âœ…' : dayData && dayData.gameOver ? 'âŒ' : 'â³';
                
                // Only show book title if completed or today
                let bookInfo = '';
                if (dayData && dayData.gameOver) {
                    const bookForDay = dayData.book || getTodaysBook(date);
                    bookInfo = `<div class="archive-book">${bookForDay.title} by ${bookForDay.author}</div>`;
                } else if (isToday) {
                    bookInfo = `<div class="archive-book">Today's puzzle</div>`;
                } else {
                    bookInfo = `<div class="archive-book">Click to play</div>`;
                }
                
                dayDiv.innerHTML = `
                    <div class="archive-info">
                        <div class="archive-date">${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })} ${isToday ? '(Today)' : ''}</div>
                        ${bookInfo}
                    </div>
                    <div class="archive-status">${statusIcon}</div>
                `;
                
                dayDiv.onclick = () => playArchiveDay(date);
                archiveList.appendChild(dayDiv);
            }
        }

        function showTodaysGame() {
            selectedDate = null;
            document.getElementById('archive-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
            initGame();
        }

        function playArchiveDay(date) {
            selectedDate = date;
            document.getElementById('archive-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
            initGame();
        }

        function resetGameUI() {
            document.getElementById('guesses-section').classList.add('hidden');
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
            document.getElementById('guess-input').value = '';
        }

        function initGame() {
            loadGameHistory();
            currentBook = getTodaysBook();
            showCurrentDate();
            resetGameUI();
            loadGameState();
            showClues();
        }

        // Handle Enter key in input
        document.getElementById('guess-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                makeGuess();
            }
        });

        // Start the game when page loads
        initGame();
    </script>
</body>
</html>
