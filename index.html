<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shelf Life | Southold Free Library</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2563eb;
            margin-bottom: 5px;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 5px;
        }
        .date {
            text-align: center;
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
        }
        .clue {
            background: #dbeafe;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2563eb;
            border-radius: 5px;
        }
        .locked {
            background: #f3f4f6;
            color: #9ca3af;
            border-left-color: #d1d5db;
        }
        input[type="text"] {
            width: 70%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1d4ed8;
        }
        .guess {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .correct {
            background: #dcfce7;
            border: 1px solid #16a34a;
        }
        .incorrect {
            background: #fef2f2;
            border: 1px solid #dc2626;
        }
        .result {
            text-align: center;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .win {
            background: #dcfce7;
            color: #166534;
        }
        .lose {
            background: #fef2f2;
            color: #991b1b;
        }
        .library-link {
            background: #dbeafe;
            padding: 15px;
            text-align: center;
            border-radius: 5px;
            margin: 15px 0;
        }
        .library-link a {
            background: #2563eb;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>ðŸ“š Shelf Life</h1>
    <p class="subtitle">Daily Book Guessing Game</p>
    <p class="date" id="current-date"></p>

    <div class="container">
        <h3>ðŸ“‹ Clues (<span id="clue-count">1</span>/6)</h3>
        <div id="clues"></div>
    </div>

    <div class="container" id="input-section">
        <h3>Your Guess</h3>
        <input type="text" id="guess-input" placeholder="Enter book title...">
        <button onclick="makeGuess()">Submit</button>
    </div>

    <div class="container hidden" id="guesses-section">
        <h3>Your Guesses (<span id="guess-count">0</span>/6)</h3>
        <div id="guesses"></div>
    </div>

    <div class="container hidden" id="result-section">
        <div id="result-text"></div>
        <div class="library-link">
            <p>ðŸ“– <strong>Available at Southold Free Library</strong></p>
            <a href="https://southold-suffc.na.iiivega.com" target="_blank">Search Our Catalog</a>
        </div>
    </div>

    <div style="text-align: center; margin-top: 30px; padding: 20px; color: #666; font-size: 14px;">
        <p>Powered by <a href="https://southoldlibrary.org" target="_blank" style="color: #2563eb; text-decoration: none;">Southold Free Library</a></p>
        <p style="font-size: 12px; margin-top: 10px;">Â© 2025 Southold Free Library. All rights reserved.</p>
    </div>

    <script>
        // Simplified book list for testing
        const books = [
            { title: "PRIDE AND PREJUDICE", author: "Jane Austen" },
            { title: "THE GREAT GATSBY", author: "F. Scott Fitzgerald" },
            { title: "TO KILL A MOCKINGBIRD", author: "Harper Lee" },
            { title: "HARRY POTTER AND THE SORCERER'S STONE", author: "J.K. Rowling" },
            { title: "NINETEEN EIGHTY-FOUR", author: "George Orwell" },
            { title: "THE HOBBIT", author: "J.R.R. Tolkien" },
            { title: "JANE EYRE", author: "Charlotte BrontÃ«" },
            { title: "THE CATCHER IN THE RYE", author: "J.D. Salinger" },
            { title: "MOBY DICK", author: "Herman Melville" },
            { title: "WAR AND PEACE", author: "Leo Tolstoy" }
        ];

        let currentBook;
        let guesses = [];
        let cluesShown = 1;
        let gameOver = false;

        function normalizeForComparison(title) {
            return title
                .toUpperCase()
                .trim()
                // Remove all punctuation and special characters
                .replace(/[^\w\s]/g, '')
                // Normalize whitespace
                .replace(/\s+/g, ' ')
                // Handle compound numbers like "NINETEEN EIGHTY FOUR" -> "1984"
                .replace(/\bNINETEEN EIGHTY FOUR\b/g, '1984')
                .replace(/\bNINETEEN EIGHTY THREE\b/g, '1983')
                .replace(/\bNINETEEN EIGHTY TWO\b/g, '1982')
                .replace(/\bNINETEEN EIGHTY ONE\b/g, '1981')
                .replace(/\bNINETEEN EIGHTY\b/g, '1980')
                .replace(/\bNINETEEN SEVENTY NINE\b/g, '1979')
                .replace(/\bNINETEEN SEVENTY EIGHT\b/g, '1978')
                .replace(/\bNINETEEN SEVENTY SEVEN\b/g, '1977')
                .replace(/\bNINETEEN SEVENTY SIX\b/g, '1976')
                .replace(/\bNINETEEN SEVENTY FIVE\b/g, '1975')
                .replace(/\bNINETEEN SEVENTY FOUR\b/g, '1974')
                .replace(/\bNINETEEN SEVENTY THREE\b/g, '1973')
                .replace(/\bNINETEEN SEVENTY TWO\b/g, '1972')
                .replace(/\bNINETEEN SEVENTY ONE\b/g, '1971')
                .replace(/\bNINETEEN SEVENTY\b/g, '1970')
                .replace(/\bTWENTY TWENTY FOUR\b/g, '2024')
                .replace(/\bTWENTY TWENTY THREE\b/g, '2023')
                .replace(/\bTWENTY TWENTY TWO\b/g, '2022')
                .replace(/\bTWENTY TWENTY ONE\b/g, '2021')
                .replace(/\bTWENTY TWENTY\b/g, '2020')
                .replace(/\bTWO THOUSAND\b/g, '2000')
                .replace(/\bTWO THOUSAND ONE\b/g, '2001')
                .replace(/\bTWO THOUSAND TWO\b/g, '2002')
                .replace(/\bTWO THOUSAND THREE\b/g, '2003')
                .replace(/\bTWO THOUSAND FOUR\b/g, '2004')
                .replace(/\bTWO THOUSAND FIVE\b/g, '2005')
                .replace(/\bTWO THOUSAND SIX\b/g, '2006')
                .replace(/\bTWO THOUSAND SEVEN\b/g, '2007')
                .replace(/\bTWO THOUSAND EIGHT\b/g, '2008')
                .replace(/\bTWO THOUSAND NINE\b/g, '2009')
                .replace(/\bTWO THOUSAND TEN\b/g, '2010')
                // Handle other compound numbers
                .replace(/\bTWENTY ONE\b/g, '21')
                .replace(/\bTWENTY TWO\b/g, '22')
                .replace(/\bTWENTY THREE\b/g, '23')
                .replace(/\bTWENTY FOUR\b/g, '24')
                .replace(/\bTWENTY FIVE\b/g, '25')
                .replace(/\bTWENTY SIX\b/g, '26')
                .replace(/\bTWENTY SEVEN\b/g, '27')
                .replace(/\bTWENTY EIGHT\b/g, '28')
                .replace(/\bTWENTY NINE\b/g, '29')
                .replace(/\bTHIRTY ONE\b/g, '31')
                .replace(/\bTHIRTY TWO\b/g, '32')
                .replace(/\bTHIRTY THREE\b/g, '33')
                .replace(/\bTHIRTY FOUR\b/g, '34')
                .replace(/\bTHIRTY FIVE\b/g, '35')
                .replace(/\bTHIRTY SIX\b/g, '36')
                .replace(/\bTHIRTY SEVEN\b/g, '37')
                .replace(/\bTHIRTY EIGHT\b/g, '38')
                .replace(/\bTHIRTY NINE\b/g, '39')
                .replace(/\bFORTY ONE\b/g, '41')
                .replace(/\bFORTY TWO\b/g, '42')
                .replace(/\bFORTY THREE\b/g, '43')
                .replace(/\bFORTY FOUR\b/g, '44')
                .replace(/\bFORTY FIVE\b/g, '45')
                .replace(/\bFORTY SIX\b/g, '46')
                .replace(/\bFORTY SEVEN\b/g, '47')
                .replace(/\bFORTY EIGHT\b/g, '48')
                .replace(/\bFORTY NINE\b/g, '49')
                .replace(/\bFIFTY ONE\b/g, '51')
                .replace(/\bFIFTY TWO\b/g, '52')
                .replace(/\bFIFTY THREE\b/g, '53')
                .replace(/\bFIFTY FOUR\b/g, '54')
                .replace(/\bFIFTY FIVE\b/g, '55')
                .replace(/\bFIFTY SIX\b/g, '56')
                .replace(/\bFIFTY SEVEN\b/g, '57')
                .replace(/\bFIFTY EIGHT\b/g, '58')
                .replace(/\bFIFTY NINE\b/g, '59')
                // Basic single numbers
                .replace(/\bONE\b/g, '1')
                .replace(/\bTWO\b/g, '2')
                .replace(/\bTHREE\b/g, '3')
                .replace(/\bFOUR\b/g, '4')
                .replace(/\bFIVE\b/g, '5')
                .replace(/\bSIX\b/g, '6')
                .replace(/\bSEVEN\b/g, '7')
                .replace(/\bEIGHT\b/g, '8')
                .replace(/\bNINE\b/g, '9')
                .replace(/\bTEN\b/g, '10')
                .replace(/\bELEVEN\b/g, '11')
                .replace(/\bTWELVE\b/g, '12')
                .replace(/\bTHIRTEEN\b/g, '13')
                .replace(/\bFOURTEEN\b/g, '14')
                .replace(/\bFIFTEEN\b/g, '15')
                .replace(/\bSIXTEEN\b/g, '16')
                .replace(/\bSEVENTEEN\b/g, '17')
                .replace(/\bEIGHTEEN\b/g, '18')
                .replace(/\bNINETEEN\b/g, '19')
                .replace(/\bTWENTY\b/g, '20')
                .replace(/\bTHIRTY\b/g, '30')
                .replace(/\bFORTY\b/g, '40')
                .replace(/\bFIFTY\b/g, '50')
                .replace(/\bSIXTY\b/g, '60')
                .replace(/\bSEVENTY\b/g, '70')
                .replace(/\bEIGHTY\b/g, '80')
                .replace(/\bNINETY\b/g, '90')
                .replace(/\bHUNDRED\b/g, '100')
                .replace(/\bTHOUSAND\b/g, '1000')
                .trim();
        }

        function titlesMatch(guess, target) {
            return normalizeForComparison(guess) === normalizeForComparison(target);
        }

        function getTodaysBook() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            return books[dayOfYear % books.length];
        }

        function showCurrentDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = today.toLocaleDateString('en-US', options);
        }

        function generateClues(book) {
            const specificClues = {
                "PRIDE AND PREJUDICE": [
                    "ðŸŒŸ A spirited woman and proud gentleman overcome first judgments to find love",
                    "ðŸ‘¤ Author: British author, Austen",
                    "ðŸ“… Published: 1813",
                    "ðŸŽ­ Themes: Social class, marriage, personal growth",
                    "ðŸ“– Setting: English countryside estates in the Regency era", 
                    "ðŸ‘¥ Character: Elizabeth Bennet"
                ],
                "THE GREAT GATSBY": [
                    "ðŸŒŸ A mysterious millionaire throws lavish parties hoping to win back his lost love",
                    "ðŸ‘¤ Author: American author, Fitzgerald",
                    "ðŸ“… Published: 1925",
                    "ðŸŽ­ Themes: The American Dream, wealth vs morality",
                    "ðŸ“– Setting: Long Island and New York City, 1922",
                    "ðŸ‘¥ Character: Jay Gatsby"
                ],
                "TO KILL A MOCKINGBIRD": [
                    "ðŸŒŸ A child witnesses her father defend an innocent man in a charged trial",
                    "ðŸ‘¤ Author: American author, Lee", 
                    "ðŸ“… Published: 1960",
                    "ðŸŽ­ Themes: Racial injustice, moral courage, loss of innocence",
                    "ðŸ“– Setting: Small town Alabama during the 1930s",
                    "ðŸ‘¥ Character: Scout Finch"
                ],
                "HARRY POTTER AND THE SORCERER'S STONE": [
                    "ðŸŒŸ An orphaned boy discovers he's famous in a magical world",
                    "ðŸ‘¤ Author: British author, Rowling",
                    "ðŸ“… Published: 1997", 
                    "ðŸŽ­ Themes: Good vs evil, friendship, coming of age",
                    "ðŸ“– Setting: A school of witchcraft and wizardry in Scotland",
                    "ðŸ‘¥ Character: Harry Potter"
                ],
                "NINETEEN EIGHTY-FOUR": [
                    "ðŸŒŸ In a surveillance state where Big Brother watches all, one man dares remember freedom",
                    "ðŸ‘¤ Author: British author, Orwell",
                    "ðŸ“… Published: 1949",
                    "ðŸŽ­ Themes: Totalitarianism, surveillance, truth manipulation",
                    "ðŸ“– Setting: Dystopian London under constant government monitoring",
                    "ðŸ‘¥ Character: Winston Smith"
                ]
            };
            
            return specificClues[book.title] || [
                "ðŸŒŸ A compelling story that has captivated readers",
                `ðŸ‘¤ Author: ${book.author.split(' ').slice(-1)[0]}`,
                "ðŸ“… Era: Classic literature",
                "ðŸŽ­ Themes: Human nature and society",
                "ðŸ“– Setting: Various meaningful locations",
                "ðŸ‘¥ Features: Memorable characters"
            ];
        }

        function showClues() {
            const clues = generateClues(currentBook);
            const cluesContainer = document.getElementById('clues');
            cluesContainer.innerHTML = '';
            
            for (let i = 0; i < cluesShown; i++) {
                const clueDiv = document.createElement('div');
                clueDiv.className = 'clue';
                clueDiv.textContent = clues[i];
                cluesContainer.appendChild(clueDiv);
            }
            
            document.getElementById('clue-count').textContent = cluesShown;
        }

        function makeGuess() {
            if (gameOver) return;
            
            const input = document.getElementById('guess-input');
            const guess = input.value.trim();
            
            if (!guess) return;
            
            const isCorrect = titlesMatch(guess, currentBook.title);
            guesses.push({ text: guess.toUpperCase(), correct: isCorrect });
            
            input.value = '';
            
            if (isCorrect) {
                gameOver = true;
                endGame(true);
            } else {
                // Always reveal a new clue after a wrong guess
                cluesShown = Math.min(6, cluesShown + 1);
                showClues();
                
                if (guesses.length >= 6) {
                    gameOver = true;
                    endGame(false);
                }
            }
            
            displayGuesses();
        }

        function displayGuesses() {
            if (guesses.length === 0) return;
            
            document.getElementById('guesses-section').classList.remove('hidden');
            const guessesContainer = document.getElementById('guesses');
            guessesContainer.innerHTML = '';
            
            guesses.forEach(guess => {
                const guessDiv = document.createElement('div');
                guessDiv.className = `guess ${guess.correct ? 'correct' : 'incorrect'}`;
                guessDiv.textContent = guess.text;
                guessesContainer.appendChild(guessDiv);
            });
            
            document.getElementById('guess-count').textContent = guesses.length;
        }

        function endGame(won = false) {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            
            const resultDiv = document.getElementById('result-text');
            if (won) {
                resultDiv.innerHTML = `
                    <div class="result win">
                        <h3>ðŸŽ‰ Congratulations!</h3>
                        <p>You guessed "${currentBook.title}" by ${currentBook.author} in ${guesses.length} guess${guesses.length === 1 ? '' : 'es'}!</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="result lose">
                        <h3>ðŸ“š Better luck next time!</h3>
                        <p>The book was "${currentBook.title}" by ${currentBook.author}</p>
                    </div>
                `;
            }
        }

        // Handle Enter key in input
        document.getElementById('guess-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                makeGuess();
            }
        });

        // Initialize the game
        function initGame() {
            currentBook = getTodaysBook();
            showCurrentDate();
            showClues();
        }

        // Start the game when page loads
        initGame();
    </script>
</body>
</html>
