<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shelf Life | Southold Free Library</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cooper+Black&display=swap');
        
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        /* Landing Page Styles */
        .landing-page {
            background: linear-gradient(135deg, #4fc3f7, #29b6f6);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            margin: -20px;
            padding: 20px;
        }
        
        .landing-title {
            font-family: 'Cooper Black', Arial, sans-serif;
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .landing-subtitle {
            font-size: 1.5rem;
            margin-bottom: 40px;
            max-width: 500px;
            line-height: 1.4;
            opacity: 0.95;
        }
        
        .play-button {
            background: #8bc34a;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .play-button:hover {
            background: #7cb342;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .landing-footer {
            position: absolute;
            bottom: 20px;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Game Styles */
        .game-container {
            display: none;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2563eb;
            margin-bottom: 5px;
            font-family: 'Cooper Black', Arial, sans-serif;
            font-weight: bold;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 5px;
        }
        
        .date {
            text-align: center;
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .clue {
            background: #dbeafe;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2563eb;
            border-radius: 5px;
            animation: slideIn 0.4s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .guess {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .correct {
            background: #dcfce7;
            border: 1px solid #16a34a;
        }
        
        .incorrect {
            background: #fef2f2;
            border: 1px solid #dc2626;
        }
        
        .result {
            text-align: center;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .win {
            background: #dcfce7;
            color: #166534;
        }
        
        .lose {
            background: #fef2f2;
            color: #991b1b;
        }
        
        .share-button {
            background: #10b981;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px;
            transition: all 0.2s ease;
        }
        
        .share-button:hover {
            background: #059669;
            transform: translateY(-1px);
        }
        
        .stats-container {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px 15px;
            margin: 10px 0;
            text-align: center;
            display: inline-block;
            margin-left: auto;
            margin-right: auto;
        }
        
        .stats-row {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 500;
        }
        
        .stat-icon {
            font-size: 18px;
        }
        
        .stat-value {
            color: #1f2937;
        }
        
        .streak-badge {
            display: inline-block;
            background: #ff6b35;
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .achievement {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            animation: bounceIn 0.6s ease-out;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        input[type="text"] {
            width: 70%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        button {
            padding: 10px 20px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        .library-link {
            background: #dbeafe;
            padding: 15px;
            text-align: center;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .library-link a {
            background: #2563eb;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
        }
        
        .hidden {
            display: none;
        }
        
        .nav-buttons {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .nav-buttons button {
            margin: 0 5px;
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .back-button:hover {
            background: rgba(255,255,255,0.3);
        }
        
        @media (max-width: 600px) {
            .landing-title {
                font-size: 3rem;
            }
            .landing-subtitle {
                font-size: 1.2rem;
            }
            .play-button {
                padding: 15px 30px;
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page" class="landing-page">
        <h1 class="landing-title">Shelf Life</h1>
        <p class="landing-subtitle">Discover the book title based on simple clues.</p>
        <button class="play-button" onclick="startGame()">play now</button>
        <div class="landing-footer">designed by anakin jackson for southold free library</div>
    </div>

    <!-- Game Container -->
    <div id="game-container" class="game-container">
        <button class="back-button" onclick="showLanding()">‚Üê Home</button>
        
        <h1>üìö Shelf Life</h1>
        <p class="subtitle">Daily Book Guessing Game</p>
        <p class="date" id="current-date"></p>

        <div style="text-align: center;">
            <div class="stats-container">
                <div class="stats-row">
                    <div class="stat-item">
                        <span class="stat-icon">üî•</span>
                        <span class="stat-value" id="streak-display">0 day streak</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button onclick="showTodaysGame()" id="today-btn">üìÖ Today's Game</button>
            <button onclick="showArchiveList()" id="archive-btn">üóÇÔ∏è Archive</button>
        </div>

        <div id="game-section">
            <div class="container">
                <h3>üìã Clues (<span id="clue-count">1</span>/6)</h3>
                <div id="clues"></div>
            </div>

            <div class="container" id="input-section">
                <h3>Your Guess</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="guess-input" placeholder="Enter book title..." style="width: 60%;">
                    <button onclick="makeGuess()" style="width: 50px; font-size: 18px;">‚Üí</button>
                    <button onclick="skipClue()" style="background: #6b7280; width: auto; padding: 10px 15px; font-size: 14px;">Skip</button>
                </div>
                <p style="font-size: 12px; color: #666; margin-top: 5px; margin-bottom: 0;">üí° Skipping reveals the next clue but counts as one of your 6 guesses</p>
            </div>

            <div class="container hidden" id="guesses-section">
                <h3>Your Guesses (<span id="guess-count">0</span>/6)</h3>
                <div id="guesses"></div>
            </div>

            <div class="container hidden" id="result-section">
                <div id="result-text"></div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="share-button" onclick="shareResults()">üìã Share Results</button>
                </div>
                <div class="library-link">
                    <p>üìñ <strong>Available at Southold Free Library</strong></p>
                    <a href="https://southold-suffc.na.iiivega.com" target="_blank">Search Our Catalog</a>
                </div>
                <div id="achievement-display"></div>
            </div>
        </div>

        <div class="container hidden" id="archive-section">
            <h3>üóÇÔ∏è Game Archive</h3>
            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">Click any day to play that puzzle</p>
            <div id="archive-list" style="max-height: 400px; overflow-y: auto;"></div>
        </div>

        <div style="text-align: center; margin-top: 30px; padding: 20px; color: #666; font-size: 14px;">
            <p>Powered by <a href="https://southoldlibrary.org" target="_blank" style="color: #2563eb; text-decoration: none;">Southold Free Library</a></p>
            <p style="font-size: 12px; margin-top: 10px;">¬© 2025 Southold Free Library. All rights reserved.</p>
        </div>
    </div>

    <script>
        // Book database
        const books = [
            { title: "PRIDE AND PREJUDICE", author: "Jane Austen" },
            { title: "THE GREAT GATSBY", author: "F. Scott Fitzgerald" },
            { title: "TO KILL A MOCKINGBIRD", author: "Harper Lee" },
            { title: "HARRY POTTER AND THE SORCERER'S STONE", author: "J.K. Rowling" },
            { title: "NINETEEN EIGHTY-FOUR", author: "George Orwell" },
            { title: "THE HOBBIT", author: "J.R.R. Tolkien" },
            { title: "JANE EYRE", author: "Charlotte Bront√´" },
            { title: "THE CATCHER IN THE RYE", author: "J.D. Salinger" },
            { title: "MOBY DICK", author: "Herman Melville" },
            { title: "WAR AND PEACE", author: "Leo Tolstoy" },
            { title: "THE LORD OF THE RINGS", author: "J.R.R. Tolkien" },
            { title: "BRAVE NEW WORLD", author: "Aldous Huxley" },
            { title: "WUTHERING HEIGHTS", author: "Emily Bront√´" },
            { title: "THE SCARLET LETTER", author: "Nathaniel Hawthorne" },
            { title: "LITTLE WOMEN", author: "Louisa May Alcott" },
            { title: "FRANKENSTEIN", author: "Mary Shelley" },
            { title: "DRACULA", author: "Bram Stoker" },
            { title: "ALICE'S ADVENTURES IN WONDERLAND", author: "Lewis Carroll" },
            { title: "THE ADVENTURES OF HUCKLEBERRY FINN", author: "Mark Twain" },
            { title: "CRIME AND PUNISHMENT", author: "Fyodor Dostoyevsky" },
            { title: "THE COUNT OF MONTE CRISTO", author: "Alexandre Dumas" },
            { title: "ANNA KARENINA", author: "Leo Tolstoy" },
            { title: "THE PICTURE OF DORIAN GRAY", author: "Oscar Wilde" },
            { title: "GREAT EXPECTATIONS", author: "Charles Dickens" },
            { title: "A TALE OF TWO CITIES", author: "Charles Dickens" },
            { title: "THE GRAPES OF WRATH", author: "John Steinbeck" },
            { title: "OF MICE AND MEN", author: "John Steinbeck" },
            { title: "FAHRENHEIT 451", author: "Ray Bradbury" },
            { title: "LORD OF THE FLIES", author: "William Golding" },
            { title: "THE OLD MAN AND THE SEA", author: "Ernest Hemingway" }
        ];

        // Game state
        let currentBook;
        let guesses = [];
        let cluesShown = 1;
        let gameOver = false;
        let selectedDate = null;
        let gameHistory = {};
        let playerStats = {
            streak: 0,
            gamesPlayed: 0,
            gamesWon: 0,
            achievements: []
        };

        // Achievements
        const achievements = [
            { id: "first_win", name: "First Victory", description: "Win your first game", emoji: "üéâ" },
            { id: "streak_3", name: "Hot Streak", description: "Win 3 days in a row", emoji: "üî•" },
            { id: "perfect_game", name: "Perfect Game", description: "Win with only 1 guess", emoji: "üíé" },
            { id: "bookworm", name: "Bookworm", description: "Play 25 games", emoji: "üìö" }
        ];

        // Utility functions
        function normalizeForComparison(title) {
            return title
                .toUpperCase()
                .trim()
                .replace(/[^\w\s]/g, '')
                .replace(/\s+/g, ' ')
                .replace(/^(THE|A|AN)\s+/g, '')
                .replace(/\bNINETEEN EIGHTY FOUR\b/g, '1984')
                .replace(/\bNINETEEN EIGHTY THREE\b/g, '1983')
                .replace(/\bNINETEEN EIGHTY TWO\b/g, '1982')
                .replace(/\bNINETEEN EIGHTY ONE\b/g, '1981')
                .replace(/\bTWENTY TWENTY FOUR\b/g, '2024')
                .replace(/\bTWENTY TWENTY THREE\b/g, '2023')
                .replace(/\bTWENTY TWENTY TWO\b/g, '2022')
                .replace(/\bTWENTY TWENTY ONE\b/g, '2021')
                .replace(/\bTWENTY TWENTY\b/g, '2020')
                .replace(/\bTWO THOUSAND\b/g, '2000')
                .replace(/\bONE\b/g, '1')
                .replace(/\bTWO\b/g, '2')
                .replace(/\bTHREE\b/g, '3')
                .replace(/\bFOUR\b/g, '4')
                .replace(/\bFIVE\b/g, '5')
                .replace(/\bSIX\b/g, '6')
                .replace(/\bSEVEN\b/g, '7')
                .replace(/\bEIGHT\b/g, '8')
                .replace(/\bNINE\b/g, '9')
                .replace(/\bTEN\b/g, '10')
                .trim();
        }

        function titlesMatch(guess, target) {
            return normalizeForComparison(guess) === normalizeForComparison(target);
        }

        function getDateKey(date) {
            return date.toISOString().split('T')[0];
        }

        function getTodaysBook(date = null) {
            const targetDate = date || selectedDate || new Date();
            const year = targetDate.getFullYear();
            const dayOfYear = Math.floor((targetDate - new Date(year, 0, 0)) / 86400000);
            const seed = year * 1000 + dayOfYear;
            const bookIndex = seed % books.length;
            return books[bookIndex];
        }

        function showCurrentDate() {
            const targetDate = selectedDate || new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = targetDate.toLocaleDateString('en-US', options);
        }

        function generateClues(book) {
            const specificClues = {
                "PRIDE AND PREJUDICE": [
                    "üåü A spirited woman and proud gentleman overcome first judgments to find love",
                    "üë§ Author: British author, Austen",
                    "üìÖ Published: 1813",
                    "üé≠ Themes: Social class, marriage, personal growth through understanding",
                    "üìñ Setting: English countryside estates in the Regency era", 
                    "üë• Character: Elizabeth Bennet"
                ],
                "THE GREAT GATSBY": [
                    "üåü A mysterious millionaire throws lavish parties hoping to win back his lost love",
                    "üë§ Author: American author, Fitzgerald",
                    "üìÖ Published: 1925",
                    "üé≠ Themes: The American Dream, wealth vs morality, impossible past",
                    "üìñ Setting: Long Island and New York City, summer of 1922",
                    "üë• Character: Jay Gatsby"
                ],
                "TO KILL A MOCKINGBIRD": [
                    "üåü A child witnesses her father defend an innocent man in a charged trial",
                    "üë§ Author: American author, Lee", 
                    "üìÖ Published: 1960",
                    "üé≠ Themes: Racial injustice, moral courage, loss of innocence",
                    "üìñ Setting: Small town Alabama during the 1930s",
                    "üë• Character: Scout Finch"
                ],
                "HARRY POTTER AND THE SORCERER'S STONE": [
                    "üåü An orphaned boy discovers he's famous in a magical world",
                    "üë§ Author: British author, Rowling",
                    "üìÖ Published: 1997", 
                    "üé≠ Themes: Good vs evil, friendship, sacrifice, coming of age",
                    "üìñ Setting: A school of witchcraft and wizardry in Scotland",
                    "üë• Character: Harry Potter"
                ],
                "NINETEEN EIGHTY-FOUR": [
                    "üåü In a surveillance state where Big Brother watches all, one man dares remember freedom",
                    "üë§ Author: British author, Orwell",
                    "üìÖ Published: 1949",
                    "üé≠ Themes: Totalitarianism, surveillance, truth manipulation, individual freedom",
                    "üìñ Setting: Dystopian London under constant government monitoring",
                    "üë• Character: Winston Smith"
                ],
                "THE HOBBIT": [
                    "üåü A reluctant home-loving creature embarks on an unexpected adventure with thirteen companions",
                    "üë§ Author: British author, Tolkien",
                    "üìÖ Published: 1937",
                    "üé≠ Themes: Adventure, courage, greed, heroism from unlikely sources",
                    "üìñ Setting: Middle-earth, including the Shire and Lonely Mountain",
                    "üë• Character: Bilbo Baggins"
                ],
                "JANE EYRE": [
                    "üåü An orphaned governess faces a brooding employer with dark secrets",
                    "üë§ Author: British author, Charlotte Bront√´",
                    "üìÖ Published: 1847",
                    "üé≠ Themes: Independence, love vs. morality, social class, religion",
                    "üìñ Setting: Yorkshire moors and Thornfield Hall in Victorian England",
                    "üë• Character: Jane Eyre"
                ],
                "THE CATCHER IN THE RYE": [
                    "üåü A troubled teenager wanders New York City after being expelled from prep school",
                    "üë§ Author: American author, Salinger",
                    "üìÖ Published: 1951",
                    "üé≠ Themes: Alienation, loss of innocence, phoniness in adult world",
                    "üìñ Setting: New York City in the 1950s",
                    "üë• Character: Holden Caulfield"
                ],
                "MOBY DICK": [
                    "üåü A ship captain's obsessive quest for revenge against a white whale",
                    "üë§ Author: American author, Melville",
                    "üìÖ Published: 1851",
                    "üé≠ Themes: Obsession, fate vs. free will, nature's power, isolation",
                    "üìñ Setting: Aboard a whaling ship sailing the world's oceans",
                    "üë• Character: Captain Ahab"
                ],
                "WAR AND PEACE": [
                    "üåü Russian aristocratic families navigate love and loss during Napoleon's invasion",
                    "üë§ Author: Russian author, Tolstoy",
                    "üìÖ Published: 1869",
                    "üé≠ Themes: War's impact, fate, love, history's forces on individuals",
                    "üìñ Setting: Russia during the Napoleonic Wars (1805-1820)",
                    "üë• Character: Pierre Bezukhov"
                ],
                "THE LORD OF THE RINGS": [
                    "üåü A fellowship forms to destroy a ring that could doom their world",
                    "üë§ Author: British author, Tolkien",
                    "üìÖ Published: 1954-1955",
                    "üé≠ Themes: Good vs. evil, friendship, sacrifice, power's corruption",
                    "üìñ Setting: Middle-earth, from the Shire to Mount Doom",
                    "üë• Character: Frodo Baggins"
                ],
                "BRAVE NEW WORLD": [
                    "üåü In a future society of engineered happiness, one man questions the system",
                    "üë§ Author: British author, Huxley",
                    "üìÖ Published: 1932",
                    "üé≠ Themes: Technology's control, individuality vs. conformity, happiness vs. truth",
                    "üìñ Setting: Futuristic World State society",
                    "üë• Character: John the Savage"
                ],
                "WUTHERING HEIGHTS": [
                    "üåü A foundling's obsessive love spans generations on the Yorkshire moors",
                    "üë§ Author: British author, Emily Bront√´",
                    "üìÖ Published: 1847",
                    "üé≠ Themes: Destructive love, revenge, social class, nature vs. civilization",
                    "üìñ Setting: Wuthering Heights and Thrushcross Grange on Yorkshire moors",
                    "üë• Character: Heathcliff"
                ],
                "THE SCARLET LETTER": [
                    "üåü A woman bears shame and an illegitimate child in Puritan New England",
                    "üë§ Author: American author, Hawthorne",
                    "üìÖ Published: 1850",
                    "üé≠ Themes: Sin and redemption, guilt, hidden truth, social judgment",
                    "üìñ Setting: Puritan Boston in the 1640s",
                    "üë• Character: Hester Prynne"
                ],
                "LITTLE WOMEN": [
                    "üåü Four sisters grow up during the Civil War, facing poverty and personal challenges",
                    "üë§ Author: American author, Alcott",
                    "üìÖ Published: 1868",
                    "üé≠ Themes: Family bonds, women's roles, poverty vs. wealth, moral growth",
                    "üìñ Setting: Concord, Massachusetts during the Civil War",
                    "üë• Character: Jo March"
                ],
                "FRANKENSTEIN": [
                    "üåü A scientist creates life but abandons his creation with horrific consequences",
                    "üë§ Author: British author, Mary Shelley",
                    "üìÖ Published: 1818",
                    "üé≠ Themes: Scientific ethics, creation vs. responsibility, isolation, revenge",
                    "üìñ Setting: Geneva, Switzerland and the Arctic",
                    "üë• Character: Victor Frankenstein"
                ],
                "DRACULA": [
                    "üåü An ancient vampire travels to England to spread his curse",
                    "üë§ Author: Irish author, Stoker",
                    "üìÖ Published: 1897",
                    "üé≠ Themes: Good vs. evil, modernity vs. tradition, fear of the foreign",
                    "üìñ Setting: Transylvania and Victorian England",
                    "üë• Character: Count Dracula"
                ],
                "ALICE'S ADVENTURES IN WONDERLAND": [
                    "üåü A curious girl falls down a rabbit hole into a world of nonsense",
                    "üë§ Author: British author, Carroll",
                    "üìÖ Published: 1865",
                    "üé≠ Themes: Growing up, logic vs. nonsense, identity, authority",
                    "üìñ Setting: Wonderland, a fantastical underground world",
                    "üë• Character: Alice"
                ],
                "THE ADVENTURES OF HUCKLEBERRY FINN": [
                    "üåü A boy and an escaped slave travel down the Mississippi River seeking freedom",
                    "üë§ Author: American author, Twain",
                    "üìÖ Published: 1884",
                    "üé≠ Themes: Racism, moral growth, freedom vs. civilization, friendship",
                    "üìñ Setting: Mississippi River in the antebellum American South",
                    "üë• Character: Huckleberry Finn"
                ],
                "CRIME AND PUNISHMENT": [
                    "üåü A student commits murder and struggles with guilt and philosophical justification",
                    "üë§ Author: Russian author, Dostoyevsky",
                    "üìÖ Published: 1866",
                    "üé≠ Themes: Guilt and redemption, morality, poverty, psychological torment",
                    "üìñ Setting: St. Petersburg, Russia in the 1860s",
                    "üë• Character: Rodion Raskolnikov"
                ],
                "THE COUNT OF MONTE CRISTO": [
                    "üåü A wrongly imprisoned man escapes and methodically seeks revenge on his betrayers",
                    "üë§ Author: French author, Dumas",
                    "üìÖ Published: 1844",
                    "üé≠ Themes: Justice vs. revenge, forgiveness, transformation, hope",
                    "üìñ Setting: France and Italy in the early 19th century",
                    "üë• Character: Edmond Dant√®s"
                ],
                "ANNA KARENINA": [
                    "üåü A married aristocrat's affair leads to tragedy while others find happiness",
                    "üë§ Author: Russian author, Tolstoy",
                    "üìÖ Published: 1877",
                    "üé≠ Themes: Love vs. duty, society's constraints, faith, family",
                    "üìñ Setting: Russian high society in the 1870s",
                    "üë• Character: Anna Karenina"
                ],
                "THE PICTURE OF DORIAN GRAY": [
                    "üåü A young man's portrait ages while he remains beautiful but morally corrupt",
                    "üë§ Author: Irish author, Wilde",
                    "üìÖ Published: 1890",
                    "üé≠ Themes: Beauty vs. morality, hedonism, art's influence, corruption",
                    "üìñ Setting: Victorian London",
                    "üë• Character: Dorian Gray"
                ],
                "GREAT EXPECTATIONS": [
                    "üåü An orphan boy receives mysterious wealth and learns hard lessons about class",
                    "üë§ Author: British author, Dickens",
                    "üìÖ Published: 1861",
                    "üé≠ Themes: Social class, ambition vs. loyalty, love, personal growth",
                    "üìñ Setting: Victorian England, London and the marshes of Kent",
                    "üë• Character: Pip"
                ],
                "A TALE OF TWO CITIES": [
                    "üåü Love and sacrifice unfold against the backdrop of the French Revolution",
                    "üë§ Author: British author, Dickens",
                    "üìÖ Published: 1859",
                    "üé≠ Themes: Sacrifice, resurrection, duality, revolution's chaos",
                    "üìñ Setting: London and Paris during the French Revolution",
                    "üë• Character: Sydney Carton"
                ],
                "THE GRAPES OF WRATH": [
                    "üåü A family of farmers travels to California during the Great Depression",
                    "üë§ Author: American author, Steinbeck",
                    "üìÖ Published: 1939",
                    "üé≠ Themes: Social injustice, family unity, human dignity, survival",
                    "üìñ Setting: Oklahoma to California during the Dust Bowl era",
                    "üë• Character: Tom Joad"
                ],
                "OF MICE AND MEN": [
                    "üåü Two migrant workers dream of owning a farm during the Great Depression",
                    "üë§ Author: American author, Steinbeck",
                    "üìÖ Published: 1937",
                    "üé≠ Themes: Friendship, loneliness, dreams vs. reality, mercy",
                    "üìñ Setting: California ranch during the Great Depression",
                    "üë• Character: George Milton"
                ],
                "FAHRENHEIT 451": [
                    "üåü In a future where books are burned, a fireman begins to question his job",
                    "üë§ Author: American author, Bradbury",
                    "üìÖ Published: 1953",
                    "üé≠ Themes: Censorship, knowledge vs. ignorance, technology's impact, rebellion",
                    "üìñ Setting: Dystopian future America",
                    "üë• Character: Guy Montag"
                ],
                "LORD OF THE FLIES": [
                    "üåü British schoolboys stranded on an island descend into savagery",
                    "üë§ Author: British author, Golding",
                    "üìÖ Published: 1954",
                    "üé≠ Themes: Civilization vs. savagery, human nature, power, loss of innocence",
                    "üìñ Setting: Uninhabited tropical island",
                    "üë• Character: Ralph"
                ],
                "THE OLD MAN AND THE SEA": [
                    "üåü An aging fisherman battles a giant marlin in the Gulf Stream",
                    "üë§ Author: American author, Hemingway",
                    "üìÖ Published: 1952",
                    "üé≠ Themes: Perseverance, dignity in defeat, man vs. nature, isolation",
                    "üìñ Setting: Cuban waters and the Gulf Stream",
                    "üë• Character: Santiago"
                ]
            };
            
            return specificClues[book.title] || [
                "üåü A compelling story that has captivated readers for generations",
                `üë§ Author: ${getAuthorNationality(book.author)}, ${book.author.split(' ').slice(-1)[0]}`,
                `üìÖ Era: ${getEstimatedYear(book.title)}`,
                `üé≠ Themes: ${getGenericThemes(book.title)}`,
                `üìñ Setting: ${getGenericSetting(book.title)}`,
                "üë• Features: Memorable characters facing profound challenges"
            ];
        }

        function getAuthorNationality(author) {
            if (author.includes('Dickens') || author.includes('Austen') || author.includes('Bront√´') || author.includes('Carroll') || author.includes('Tolkien')) return 'British author';
            if (author.includes('Twain') || author.includes('Hemingway') || author.includes('Steinbeck') || author.includes('Fitzgerald')) return 'American author';
            if (author.includes('Tolstoy') || author.includes('Dostoyevsky')) return 'Russian author';
            if (author.includes('Hugo') || author.includes('Dumas')) return 'French author';
            return 'International author';
        }

        function getEstimatedYear(title) {
            if (title.includes('HARRY POTTER')) return '1990s-2000s';
            if (title.includes('HUNGER GAMES') || title.includes('TWILIGHT')) return '2000s-2010s';
            if (title.includes('DA VINCI') || title.includes('KITE RUNNER')) return 'Modern era';
            return 'Classic period';
        }

        function getGenericThemes(title) {
            if (title.includes('WAR') || title.includes('BATTLE')) return 'Conflict, courage, human cost of war';
            if (title.includes('LOVE') || title.includes('ROMANCE')) return 'Love, relationships, passion, heartbreak';
            if (title.includes('MURDER') || title.includes('CRIME')) return 'Mystery, justice, human nature';
            if (title.includes('ADVENTURE')) return 'Adventure, discovery, personal growth';
            return 'Human nature, morality, society, personal growth';
        }

        function getGenericSetting(title) {
            if (title.includes('LONDON') || title.includes('ENGLAND') || title.includes('BRITISH')) return 'England';
            if (title.includes('PARIS') || title.includes('FRANCE')) return 'France';
            if (title.includes('AMERICA') || title.includes('NEW YORK')) return 'America';
            if (title.includes('WAR')) return 'Times and places of conflict';
            if (title.includes('FUTURE') || title.includes('SPACE')) return 'Future or imaginary worlds';
            return 'Various meaningful locations that shape the story';
        }

        // Game functions
        function loadGameHistory() {
            try {
                const saved = localStorage.getItem('shelflife-history');
                gameHistory = saved ? JSON.parse(saved) : {};
                
                const savedStats = localStorage.getItem('shelflife-stats');
                if (savedStats) {
                    playerStats = { ...playerStats, ...JSON.parse(savedStats) };
                }
                
                updateStatsDisplay();
            } catch (e) {
                gameHistory = {};
            }
        }

        function saveGameHistory() {
            try {
                localStorage.setItem('shelflife-history', JSON.stringify(gameHistory));
                localStorage.setItem('shelflife-stats', JSON.stringify(playerStats));
            } catch (e) {
                // localStorage not available
            }
        }

        function updateStatsDisplay() {
            document.getElementById('streak-display').textContent = `${playerStats.streak} day streak`;
        }

        function showClues() {
            const clues = generateClues(currentBook);
            const cluesContainer = document.getElementById('clues');
            cluesContainer.innerHTML = '';
            
            for (let i = 0; i < cluesShown; i++) {
                const clueDiv = document.createElement('div');
                clueDiv.className = 'clue';
                clueDiv.textContent = clues[i];
                cluesContainer.appendChild(clueDiv);
            }
            
            document.getElementById('clue-count').textContent = cluesShown;
        }

        function skipClue() {
            if (gameOver || cluesShown >= 6) return;
            
            guesses.push({ text: "(SKIPPED)", correct: false, isSkip: true });
            cluesShown = Math.min(6, cluesShown + 1);
            showClues();
            
            if (guesses.length >= 6) {
                gameOver = true;
                endGame(false);
            }
            
            displayGuesses();
            saveGameState();
        }

        function makeGuess() {
            if (gameOver) return;
            
            const input = document.getElementById('guess-input');
            const guess = input.value.trim();
            
            if (!guess) return;
            
            const isCorrect = titlesMatch(guess, currentBook.title);
            guesses.push({ text: guess.toUpperCase(), correct: isCorrect });
            
            input.value = '';
            
            if (isCorrect) {
                gameOver = true;
                playerStats.gamesPlayed++;
                playerStats.gamesWon++;
                playerStats.streak++;
                
                checkAchievements(true);
                endGame(true);
            } else {
                cluesShown = Math.min(6, cluesShown + 1);
                showClues();
                
                if (guesses.length >= 6) {
                    gameOver = true;
                    playerStats.gamesPlayed++;
                    playerStats.streak = 0;
                    endGame(false);
                }
            }
            
            displayGuesses();
            saveGameState();
        }

        function displayGuesses() {
            if (guesses.length === 0) return;
            
            document.getElementById('guesses-section').classList.remove('hidden');
            const guessesContainer = document.getElementById('guesses');
            guessesContainer.innerHTML = '';
            
            guesses.forEach(guess => {
                const guessDiv = document.createElement('div');
                if (guess.isSkip) {
                    guessDiv.className = 'guess';
                    guessDiv.style.background = '#f3f4f6';
                    guessDiv.style.border = '1px solid #d1d5db';
                    guessDiv.style.color = '#6b7280';
                    guessDiv.style.fontStyle = 'italic';
                } else {
                    guessDiv.className = `guess ${guess.correct ? 'correct' : 'incorrect'}`;
                }
                guessDiv.textContent = guess.text;
                guessesContainer.appendChild(guessDiv);
            });
            
            document.getElementById('guess-count').textContent = guesses.length;
        }

        function endGame(won = false) {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            
            const resultDiv = document.getElementById('result-text');
            if (won) {
                const actualGuesses = guesses.filter(g => !g.isSkip).length;
                resultDiv.innerHTML = `
                    <div class="result win">
                        <h3>üéâ Congratulations!</h3>
                        <p>You guessed "${currentBook.title}" by ${currentBook.author} in ${actualGuesses} guess${actualGuesses === 1 ? '' : 'es'}!</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="result lose">
                        <h3>üìö Better luck next time!</h3>
                        <p>The book was "${currentBook.title}" by ${currentBook.author}</p>
                    </div>
                `;
            }
            
            updateStatsDisplay();
        }

        function checkAchievements(won) {
            const newAchievements = [];
            
            if (won && !playerStats.achievements.includes('first_win') && playerStats.gamesWon === 1) {
                newAchievements.push('first_win');
            }
            
            if (won && guesses.filter(g => !g.isSkip).length === 1 && !playerStats.achievements.includes('perfect_game')) {
                newAchievements.push('perfect_game');
            }
            
            if (playerStats.streak >= 3 && !playerStats.achievements.includes('streak_3')) {
                newAchievements.push('streak_3');
            }
            
            if (playerStats.gamesPlayed >= 25 && !playerStats.achievements.includes('bookworm')) {
                newAchievements.push('bookworm');
            }
            
            newAchievements.forEach(achievementId => {
                if (!playerStats.achievements.includes(achievementId)) {
                    playerStats.achievements.push(achievementId);
                    showAchievement(achievementId);
                }
            });
        }

        function showAchievement(achievementId) {
            const achievement = achievements.find(a => a.id === achievementId);
            if (!achievement) return;
            
            const achievementEl = document.createElement('div');
            achievementEl.className = 'achievement';
            achievementEl.innerHTML = `
                <strong>${achievement.emoji} ${achievement.name}</strong><br>
                <span style="font-size: 12px;">${achievement.description}</span>
            `;
            
            document.getElementById('achievement-display').appendChild(achievementEl);
        }

        function shareResults() {
            const dateKey = getDateKey(selectedDate || new Date());
            const gameData = gameHistory[dateKey];
            
            if (!gameData) return;
            
            const dayNumber = Math.floor((new Date() - new Date('2024-01-01')) / 86400000) + 1;
            const guessEmojis = gameData.guesses.map(guess => {
                if (guess.isSkip) return '‚è≠Ô∏è';
                return guess.correct ? 'üü©' : 'üü•';
            });
            
            while (guessEmojis.length < 6 && gameData.won) {
                guessEmojis.push('‚¨ú');
            }
            
            const result = gameData.won ? `${guessEmojis.length}/6` : 'X/6';
            const shareText = `Shelf Life #${dayNumber} ${result}\n\n${guessEmojis.join('')}\n\nPlay at: ${window.location.href}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Results copied to clipboard!');
                });
            } else {
                prompt('Copy this text to share:', shareText);
            }
        }

        function saveGameState() {
            const dateKey = getDateKey(selectedDate || new Date());
            gameHistory[dateKey] = {
                guesses: guesses,
                cluesShown: cluesShown,
                gameOver: gameOver,
                won: gameOver && guesses.some(g => g.correct),
                book: currentBook
            };
            saveGameHistory();
        }

        function loadGameState() {
            const dateKey = getDateKey(selectedDate || new Date());
            const savedGame = gameHistory[dateKey];
            
            if (savedGame) {
                guesses = savedGame.guesses || [];
                cluesShown = savedGame.cluesShown || 1;
                gameOver = savedGame.gameOver || false;
                
                displayGuesses();
                if (gameOver) {
                    endGame(savedGame.won);
                }
            } else {
                guesses = [];
                cluesShown = 1;
                gameOver = false;
            }
        }

        function showArchiveList() {
            document.getElementById('game-section').classList.add('hidden');
            document.getElementById('archive-section').classList.remove('hidden');
            
            const archiveList = document.getElementById('archive-list');
            archiveList.innerHTML = '';
            
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                
                const dateKey = getDateKey(date);
                const dayData = gameHistory[dateKey];
                const isToday = dateKey === getDateKey(new Date());
                
                const dayDiv = document.createElement('div');
                dayDiv.className = `archive-day ${dayData && dayData.won ? 'completed' : ''} ${isToday ? 'current' : ''}`;
                
                const statusIcon = dayData && dayData.won ? '‚úÖ' : dayData && dayData.gameOver ? '‚ùå' : '‚è≥';
                
                let bookInfo = '';
                if (dayData && dayData.gameOver) {
                    const bookForDay = dayData.book || getTodaysBook(date);
                    bookInfo = `<div style="font-size: 12px; color: #666; margin-top: 2px;">${bookForDay.title} by ${bookForDay.author}</div>`;
                } else if (isToday) {
                    bookInfo = `<div style="font-size: 12px; color: #666; margin-top: 2px;">Today's puzzle</div>`;
                } else {
                    bookInfo = `<div style="font-size: 12px; color: #666; margin-top: 2px;">Click to play</div>`;
                }
                
                dayDiv.innerHTML = `
                    <div style="display: flex; flex-direction: column; align-items: flex-start;">
                        <div style="font-weight: bold; color: #333;">${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })} ${isToday ? '(Today)' : ''}</div>
                        ${bookInfo}
                    </div>
                    <div style="font-size: 18px;">${statusIcon}</div>
                `;
                
                dayDiv.style.padding = '12px';
                dayDiv.style.margin = '8px 0';
                dayDiv.style.background = dayData && dayData.won ? '#dcfce7' : isToday ? '#dbeafe' : '#f8f9fa';
                dayDiv.style.border = `1px solid ${dayData && dayData.won ? '#16a34a' : isToday ? '#2563eb' : '#ddd'}`;
                dayDiv.style.borderRadius = '8px';
                dayDiv.style.cursor = 'pointer';
                dayDiv.style.display = 'flex';
                dayDiv.style.justifyContent = 'space-between';
                dayDiv.style.alignItems = 'center';
                dayDiv.style.transition = 'all 0.2s';
                
                dayDiv.onclick = () => playArchiveDay(date);
                dayDiv.onmouseover = () => {
                    dayDiv.style.transform = 'translateY(-1px)';
                    dayDiv.style.background = '#e9ecef';
                };
                dayDiv.onmouseout = () => {
                    dayDiv.style.transform = 'translateY(0)';
                    dayDiv.style.background = dayData && dayData.won ? '#dcfce7' : isToday ? '#dbeafe' : '#f8f9fa';
                };
                
                archiveList.appendChild(dayDiv);
            }
        }

        function showTodaysGame() {
            selectedDate = null;
            document.getElementById('archive-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
            initGame();
        }

        function playArchiveDay(date) {
            selectedDate = date;
            document.getElementById('archive-section').classList.add('hidden');
            document.getElementById('game-section').classList.remove('hidden');
            initGame();
        }

        function resetGameUI() {
            document.getElementById('guesses-section').classList.add('hidden');
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
            document.getElementById('guess-input').value = '';
            document.getElementById('achievement-display').innerHTML = '';
        }

        function initGame() {
            loadGameHistory();
            currentBook = getTodaysBook();
            showCurrentDate();
            resetGameUI();
            loadGameState();
            showClues();
            updateStatsDisplay();
        }

        function startGame() {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            initGame();
        }

        function showLanding() {
            document.getElementById('game-container').style.display = 'none';
            document.getElementById('landing-page').style.display = 'flex';
            selectedDate = null;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadGameHistory();
            
            // Add Enter key support
            document.getElementById('guess-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    makeGuess();
                }
            });
        });
    </script>
</body>
</html>
